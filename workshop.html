<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiver — Workshop</title>
<link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=DM+Mono:wght@300;400&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0f0f0f;--surface:rgba(15,15,15,0.82);--surface2:rgba(30,30,30,0.9);
  --white:#fff;--muted:rgba(255,255,255,0.4);--faint:rgba(255,255,255,0.1);
  --good:#22c55e;--fair:#f5c800;--poor:#ef4444;
  --accent:#f5c800;
}
*{margin:0;padding:0;box-sizing:border-box;}
html,body{height:100%;}
body{
  font-family:'Archivo Black',sans-serif;color:var(--white);
  background:#0f0f0f;overflow-x:hidden;min-height:100vh;
}

/* BG */
.bg-photo{position:fixed;inset:0;z-index:0;}
.bg-overlay{
  position:fixed;inset:0;z-index:1;
  background:linear-gradient(
    to bottom,
    rgba(0,0,0,0.25) 0%,
    rgba(0,0,0,0.15) 40%,
    rgba(0,0,0,0.65) 80%,
    rgba(0,0,0,0.92) 100%
  );
}
body::after{content:'';position:fixed;inset:0;pointer-events:none;z-index:9999;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='4' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  opacity:0.06;mix-blend-mode:overlay;}

/* HEADER */
header{position:relative;z-index:10;padding:18px 28px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid rgba(255,255,255,0.08);background:rgba(0,0,0,0.3);backdrop-filter:blur(8px);}
.logo-wrap{}
.logo{font-size:18px;letter-spacing:2px;}
.logo-tag{font-family:'DM Mono',monospace;font-size:7px;letter-spacing:3px;text-transform:uppercase;color:var(--muted);margin-top:2px;}
.main-nav{display:flex;gap:0;border:1px solid rgba(255,255,255,0.12);flex:1;margin:0 32px;}
.nav-link{flex:1;text-align:center;font-family:'DM Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;padding:11px 20px;color:var(--muted);text-decoration:none;border-right:1px solid rgba(255,255,255,0.12);transition:all 0.15s;}
.nav-link:last-child{border-right:none;}
.nav-link:hover{color:var(--white);background:rgba(255,255,255,0.06);}
.nav-link.active{color:var(--white);background:rgba(255,255,255,0.08);}
.profile-btn{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;color:var(--muted);background:none;border:1px solid rgba(255,255,255,0.15);padding:7px 14px;cursor:pointer;}
.profile-btn:hover{border-color:rgba(255,255,255,0.35);color:rgba(255,255,255,0.7);}

/* MODAL */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.88);z-index:1000;display:none;align-items:center;justify-content:center;padding:24px;}
.modal-backdrop.show{display:flex;}
.modal{background:#1a1a1a;max-width:480px;width:100%;padding:36px;border:1px solid rgba(255,255,255,0.1);}
.modal-title{font-size:22px;letter-spacing:-0.5px;margin-bottom:6px;}
.modal-sub{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;color:var(--muted);margin-bottom:32px;}
.field{margin-bottom:22px;}
.field-label{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;color:rgba(255,255,255,0.6);margin-bottom:10px;display:block;}
.field select,.field input{width:100%;background:#111;border:1px solid rgba(255,255,255,0.15);color:var(--white);font-family:'DM Mono',monospace;font-size:12px;padding:12px 14px;outline:none;appearance:none;}
.modal-btn{width:100%;background:var(--white);color:#0f0f0f;border:none;font-family:'Archivo Black',sans-serif;font-size:13px;letter-spacing:1px;padding:16px;cursor:pointer;}

/* LAYOUT */
.page{position:relative;z-index:5;min-height:calc(100vh - 65px);display:flex;flex-direction:column;}

/* ONBOARDING (first time setup for workshop) */
.onboard-wrap{flex:1;display:flex;align-items:center;justify-content:center;padding:40px 24px;}
.onboard-card{background:rgba(10,10,10,0.88);border:1px solid rgba(255,255,255,0.1);backdrop-filter:blur(12px);max-width:520px;width:100%;padding:40px;}
.onboard-title{font-size:clamp(28px,6vw,48px);letter-spacing:-1px;line-height:0.95;margin-bottom:8px;}
.onboard-sub{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:3px;text-transform:uppercase;color:var(--muted);margin-bottom:36px;}
.q-field{margin-bottom:20px;}
.q-label{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;color:rgba(255,255,255,0.5);margin-bottom:10px;display:block;}
.q-select,.q-input{width:100%;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.12);color:var(--white);font-family:'DM Mono',monospace;font-size:12px;padding:13px 16px;outline:none;appearance:none;transition:border-color 0.2s;}
.q-select:focus,.q-input:focus{border-color:rgba(255,255,255,0.35);}
.q-input::placeholder{color:rgba(255,255,255,0.25);}
.q-textarea{width:100%;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.12);color:var(--white);font-family:'DM Mono',monospace;font-size:12px;padding:13px 16px;outline:none;resize:none;height:80px;transition:border-color 0.2s;}
.q-textarea:focus{border-color:rgba(255,255,255,0.35);}
.q-textarea::placeholder{color:rgba(255,255,255,0.25);}
.start-btn{width:100%;background:var(--accent);color:#0f0f0f;border:none;font-family:'Archivo Black',sans-serif;font-size:13px;letter-spacing:1px;padding:18px;cursor:pointer;margin-top:8px;transition:opacity 0.15s;}
.start-btn:hover{opacity:0.9;}
.start-btn:disabled{opacity:0.4;cursor:not-allowed;}

/* CHAT */
.chat-wrap{flex:1;display:flex;flex-direction:column;max-width:760px;width:100%;margin:0 auto;padding:28px 24px 0;}
.chat-header{margin-bottom:20px;}
.chat-title{font-size:clamp(22px,4vw,36px);letter-spacing:-0.5px;}
.chat-sub{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;color:var(--muted);margin-top:6px;}
.chat-messages{flex:1;overflow-y:auto;padding-bottom:16px;display:flex;flex-direction:column;gap:16px;max-height:calc(100vh - 340px);}
.chat-messages::-webkit-scrollbar{width:3px;}
.chat-messages::-webkit-scrollbar-track{background:transparent;}
.chat-messages::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.15);}
.msg{max-width:88%;}
.msg.user{align-self:flex-end;}
.msg.assistant{align-self:flex-start;}
.msg-bubble{padding:14px 18px;font-family:'DM Mono',monospace;font-size:12px;line-height:1.7;}
.msg.user .msg-bubble{background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.12);color:rgba(255,255,255,0.9);}
.msg.assistant .msg-bubble{background:rgba(245,200,0,0.08);border:1px solid rgba(245,200,0,0.2);color:rgba(255,255,255,0.88);}
.msg-label{font-family:'DM Mono',monospace;font-size:7px;letter-spacing:2px;text-transform:uppercase;color:var(--muted);margin-bottom:5px;}
.msg.user .msg-label{text-align:right;}
.typing{display:flex;gap:4px;align-items:center;padding:14px 18px;background:rgba(245,200,0,0.06);border:1px solid rgba(245,200,0,0.15);width:fit-content;}
.typing span{width:6px;height:6px;background:var(--accent);border-radius:50%;animation:bounce 1.2s infinite;}
.typing span:nth-child(2){animation-delay:0.2s;}
.typing span:nth-child(3){animation-delay:0.4s;}
@keyframes bounce{0%,60%,100%{transform:translateY(0);}30%{transform:translateY(-6px);}}
.chat-input-wrap{position:sticky;bottom:0;padding:16px 0 28px;background:linear-gradient(to bottom,transparent,rgba(0,0,0,0.9) 40%);}
.chat-input-row{display:flex;gap:0;border:1px solid rgba(255,255,255,0.15);background:rgba(10,10,10,0.9);backdrop-filter:blur(8px);}
.chat-input{flex:1;background:none;border:none;color:var(--white);font-family:'DM Mono',monospace;font-size:12px;padding:16px 18px;outline:none;}
.chat-input::placeholder{color:rgba(255,255,255,0.25);}
.send-btn{background:var(--accent);border:none;color:#0f0f0f;font-family:'Archivo Black',sans-serif;font-size:11px;letter-spacing:1px;padding:0 22px;cursor:pointer;transition:opacity 0.15s;white-space:nowrap;}
.send-btn:hover{opacity:0.85;}
.send-btn:disabled{opacity:0.3;cursor:not-allowed;}
.reset-btn{font-family:'DM Mono',monospace;font-size:8px;letter-spacing:2px;text-transform:uppercase;color:var(--muted);background:none;border:none;cursor:pointer;padding:6px 0;margin-top:8px;}
.reset-btn:hover{color:rgba(255,255,255,0.6);}

@media(max-width:640px){
  header{padding:14px 18px;}
  .main-nav{display:none;}
  .chat-messages{max-height:calc(100vh - 300px);}
}

/* MOBILE BOTTOM NAV */
.bottom-nav {
  display: none;
  position: fixed;
  bottom: 0; left: 0; right: 0;
  background: rgba(10,10,10,0.97);
  border-top: 1px solid rgba(255,255,255,0.1);
  z-index: 500;
  padding: 10px 0 max(10px, env(safe-area-inset-bottom));
  backdrop-filter: blur(12px);
}
.bottom-nav-item {
  flex: 1; display: flex; flex-direction: column;
  align-items: center; gap: 4px;
  color: rgba(255,255,255,0.35);
  text-decoration: none;
  font-family: 'DM Mono', monospace;
  font-size: 9px; letter-spacing: 1.5px; text-transform: uppercase;
  transition: color 0.15s;
  padding: 4px 0;
}
.bottom-nav-item svg { width: 20px; height: 20px; }
.bottom-nav-item:hover,
.bottom-nav-item.active { color: #ffffff; }
.bottom-nav-item.active svg { stroke: #f5c800; }
@media (max-width: 640px) {
  .bottom-nav { display: flex; }
  .main-nav { display: none !important; }
  body { padding-bottom: 72px; }
}

</style>
</head>
<body>

<div class="bg-photo">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 700" width="100%" height="100%" preserveAspectRatio="xMidYMid slice" style="position:absolute;inset:0;width:100%;height:100%;">
  <defs>
    <radialGradient id="roomGrad" cx="45%" cy="35%" r="65%">
      <stop offset="0%" stop-color="#2a1f0e"/>
      <stop offset="100%" stop-color="#0a0805"/>
    </radialGradient>
    <radialGradient id="lightGrad" cx="50%" cy="0%" r="80%">
      <stop offset="0%" stop-color="#ffe8a0" stop-opacity="0.18"/>
      <stop offset="100%" stop-color="#ffe8a0" stop-opacity="0"/>
    </radialGradient>
    <radialGradient id="workLight" cx="50%" cy="20%" r="50%">
      <stop offset="0%" stop-color="#fff4cc" stop-opacity="0.22"/>
      <stop offset="100%" stop-color="#fff4cc" stop-opacity="0"/>
    </radialGradient>
    <filter id="softGlow">
      <feGaussianBlur stdDeviation="3" result="blur"/>
      <feComposite in="SourceGraphic" in2="blur" operator="over"/>
    </filter>
    <filter id="dust">
      <feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="4" stitchTiles="stitch"/>
      <feColorMatrix type="saturate" values="0"/>
      <feBlend in="SourceGraphic" mode="overlay" result="blend"/>
      <feComposite in="blend" in2="SourceGraphic" operator="in"/>
    </filter>
  </defs>

  <!-- Room background -->
  <rect width="900" height="700" fill="url(#roomGrad)"/>

  <!-- Back wall -->
  <rect x="0" y="0" width="900" height="480" fill="#1a1208" opacity="0.6"/>

  <!-- Ceiling work light beam -->
  <polygon points="390,0 510,0 580,260 320,260" fill="url(#lightGrad)"/>
  <polygon points="420,0 480,0 520,180 380,180" fill="url(#workLight)"/>

  <!-- Overhead work light fixture -->
  <rect x="410" y="0" width="80" height="8" fill="#2a2218" rx="2"/>
  <rect x="430" y="8" width="40" height="6" fill="#1a1410"/>
  <ellipse cx="450" cy="22" rx="22" ry="10" fill="#ffe8a0" opacity="0.9" filter="url(#softGlow)"/>
  <ellipse cx="450" cy="22" rx="16" ry="7" fill="#fff5cc"/>
  <!-- Light cord -->
  <line x1="450" y1="0" x2="450" y2="14" stroke="#333" stroke-width="2"/>

  <!-- Back wall shelves with tools -->
  <!-- Shelf 1 -->
  <rect x="60" y="120" width="180" height="6" fill="#2a1f0e" rx="1"/>
  <rect x="60" y="126" width="180" height="3" fill="#1a1208"/>
  <!-- Planers on shelf -->
  <rect x="70" y="98" width="45" height="22" rx="4" fill="#3d2e18" stroke="#5a4020" stroke-width="1"/>
  <rect x="78" y="102" width="29" height="6" rx="2" fill="#2a1f10"/>
  <rect x="82" y="108" width="8" height="12" rx="1" fill="#4a3520"/>
  <!-- Hand plane -->
  <rect x="125" y="100" width="55" height="20" rx="3" fill="#4a3820" stroke="#6a5030" stroke-width="1"/>
  <rect x="130" y="104" width="45" height="8" rx="1" fill="#3a2a14"/>
  <path d="M140 104 L140 96 L155 96 L155 104" fill="#5a4228" stroke="#6a5030" stroke-width="0.5"/>
  <!-- Sanding block -->
  <rect x="190" y="104" width="40" height="16" rx="2" fill="#6b5a3a" stroke="#8a7050" stroke-width="1"/>

  <!-- Shelf 2 - fins and templates -->
  <rect x="680" y="100" width="160" height="5" fill="#2a1f0e" rx="1"/>
  <!-- Fin templates -->
  <path d="M695 70 Q700 95 710 100 L705 100 Q698 95 692 70Z" fill="#3a2c18" stroke="#5a4020" stroke-width="1"/>
  <path d="M715 65 Q722 92 734 100 L728 100 Q719 92 710 65Z" fill="#3a2c18" stroke="#5a4020" stroke-width="1"/>
  <path d="M740 68 Q746 93 756 100 L751 100 Q744 93 737 68Z" fill="#4a3820" stroke="#6a5030" stroke-width="1"/>
  <!-- Spray can -->
  <rect x="775" y="68" width="18" height="32" rx="4" fill="#5a1a1a" stroke="#8a3030" stroke-width="1"/>
  <rect x="778" y="64" width="12" height="6" rx="2" fill="#4a1414"/>
  <ellipse cx="784" cy="64" rx="6" ry="3" fill="#6a2020"/>
  <!-- Another spray can -->
  <rect x="800" y="70" width="18" height="30" rx="4" fill="#1a3a5a" stroke="#305080" stroke-width="1"/>
  <rect x="803" y="66" width="12" height="6" rx="2" fill="#142a44"/>

  <!-- Shaping rack / horses -->
  <!-- Left horse -->
  <rect x="170" y="330" width="8" height="100" fill="#3a2c18" rx="2"/>
  <rect x="200" y="330" width="8" height="100" fill="#3a2c18" rx="2"/>
  <rect x="155" y="320" width="68" height="12" rx="3" fill="#4a3820" stroke="#6a5030" stroke-width="1"/>
  <line x1="175" y1="380" x2="202" y2="380" stroke="#2a1f10" stroke-width="3"/>
  <!-- Left horse legs spread -->
  <line x1="174" y1="430" x2="155" y2="460" stroke="#3a2c18" stroke-width="5" stroke-linecap="round"/>
  <line x1="174" y1="430" x2="193" y2="460" stroke="#3a2c18" stroke-width="5" stroke-linecap="round"/>
  <line x1="208" y1="430" x2="195" y2="460" stroke="#3a2c18" stroke-width="5" stroke-linecap="round"/>
  <line x1="208" y1="430" x2="225" y2="460" stroke="#3a2c18" stroke-width="5" stroke-linecap="round"/>

  <!-- Right horse -->
  <rect x="630" y="330" width="8" height="100" fill="#3a2c18" rx="2"/>
  <rect x="660" y="330" width="8" height="100" fill="#3a2c18" rx="2"/>
  <rect x="618" y="320" width="68" height="12" rx="3" fill="#4a3820" stroke="#6a5030" stroke-width="1"/>
  <line x1="635" y1="380" x2="662" y2="380" stroke="#2a1f10" stroke-width="3"/>
  <!-- Right horse legs -->
  <line x1="634" y1="430" x2="615" y2="460" stroke="#3a2c18" stroke-width="5" stroke-linecap="round"/>
  <line x1="634" y1="430" x2="653" y2="460" stroke="#3a2c18" stroke-width="5" stroke-linecap="round"/>
  <line x1="668" y1="430" x2="655" y2="460" stroke="#3a2c18" stroke-width="5" stroke-linecap="round"/>
  <line x1="668" y1="430" x2="685" y2="460" stroke="#3a2c18" stroke-width="5" stroke-linecap="round"/>

  <!-- SURFBOARD blank on the horses - longboard shape -->
  <ellipse cx="420" cy="325" rx="215" ry="38" fill="#e8e0cc" stroke="#d4c8a8" stroke-width="1.5"/>
  <!-- Board detail - stringer -->
  <line x1="210" y1="325" x2="630" y2="325" stroke="#c8b890" stroke-width="1.5" opacity="0.6"/>
  <!-- Board shadow underside -->
  <ellipse cx="420" cy="330" rx="210" ry="18" fill="#b8a878" opacity="0.3"/>
  <!-- Board nose rocker hint -->
  <path d="M205 325 Q208 318 215 316" stroke="#d4c8a8" stroke-width="1" fill="none" opacity="0.5"/>
  <!-- Foam dust on board surface -->
  <ellipse cx="380" cy="318" rx="25" ry="6" fill="white" opacity="0.15"/>
  <ellipse cx="460" cy="322" rx="18" ry="4" fill="white" opacity="0.12"/>
  <ellipse cx="310" cy="320" rx="15" ry="5" fill="white" opacity="0.1"/>

  <!-- SHAPER FIGURE -->
  <!-- Shadow on floor -->
  <ellipse cx="420" cy="490" rx="60" ry="12" fill="black" opacity="0.35"/>

  <!-- Back leg -->
  <line x1="410" y1="440" x2="390" y2="490" stroke="#2a2218" stroke-width="12" stroke-linecap="round"/>
  <!-- Back foot -->
  <ellipse cx="385" cy="492" rx="16" ry="6" fill="#1a1510" transform="rotate(-5,385,492)"/>

  <!-- Front leg -->
  <line x1="430" y1="438" x2="450" y2="488" stroke="#2a2218" stroke-width="12" stroke-linecap="round"/>
  <!-- Front foot -->
  <ellipse cx="455" cy="490" rx="18" ry="6" fill="#1a1510" transform="rotate(8,455,490)"/>

  <!-- Torso -->
  <path d="M395 370 Q400 360 420 355 Q440 360 445 370 L450 440 Q435 448 420 448 Q405 448 390 440Z" 
        fill="#1e1a14" stroke="#2a2418" stroke-width="1"/>
  <!-- Shirt detail / work apron suggestion -->
  <path d="M405 370 Q420 365 435 370 L438 420 Q420 428 402 420Z" fill="#2a2418" opacity="0.5"/>

  <!-- Left arm - reaching forward over board -->
  <path d="M400 385 Q370 368 345 350 Q330 338 320 330" stroke="#2a2218" stroke-width="11" stroke-linecap="round" fill="none"/>
  <!-- Left hand on board -->
  <ellipse cx="316" cy="328" rx="10" ry="7" fill="#3a2c1e" transform="rotate(-15,316,328)"/>

  <!-- Right arm - holding planer tool -->
  <path d="M442 382 Q468 362 490 345 Q505 335 515 330" stroke="#2a2218" stroke-width="11" stroke-linecap="round" fill="none"/>
  <!-- Right hand -->
  <ellipse cx="518" cy="328" rx="10" ry="7" fill="#3a2c1e" transform="rotate(10,518,328)"/>

  <!-- Planer tool in right hand -->
  <rect x="510" y="315" width="48" height="18" rx="4" fill="#4a3820" stroke="#6a5030" stroke-width="1.5"/>
  <rect x="516" y="319" width="36" height="7" rx="2" fill="#3a2814"/>
  <!-- Planer blade -->
  <rect x="510" y="331" width="48" height="3" rx="1" fill="#8a8888" opacity="0.8"/>
  <!-- Handle -->
  <path d="M528 315 L528 306 Q534 300 542 300 Q550 300 556 306 L556 315" fill="#5a4228" stroke="#6a5030" stroke-width="1"/>

  <!-- Neck -->
  <rect x="413" y="350" width="14" height="18" rx="5" fill="#3a2c1e"/>

  <!-- Head -->
  <ellipse cx="420" cy="338" rx="22" ry="24" fill="#3a2c1e"/>
  <!-- Face direction - looking down at board -->
  <ellipse cx="420" cy="342" rx="19" ry="20" fill="#3d2e20"/>
  <!-- Hair suggestion -->
  <path d="M400 330 Q408 318 420 316 Q432 318 440 330" fill="#1a1208" stroke="none"/>
  <!-- Ear -->
  <ellipse cx="398" cy="338" rx="5" ry="7" fill="#3a2c1e"/>

  <!-- Foam dust particles floating -->
  <circle cx="360" cy="295" r="3" fill="white" opacity="0.5"/>
  <circle cx="375" cy="280" r="2" fill="white" opacity="0.4"/>
  <circle cx="395" cy="270" r="1.5" fill="white" opacity="0.35"/>
  <circle cx="480" cy="285" r="2.5" fill="white" opacity="0.45"/>
  <circle cx="500" cy="268" r="2" fill="white" opacity="0.3"/>
  <circle cx="465" cy="275" r="1.5" fill="white" opacity="0.4"/>
  <circle cx="340" cy="305" r="2" fill="white" opacity="0.3"/>
  <circle cx="520" cy="295" r="3" fill="white" opacity="0.35"/>
  <circle cx="535" cy="278" r="1.5" fill="white" opacity="0.25"/>
  <circle cx="420" cy="265" r="2" fill="white" opacity="0.4"/>
  <circle cx="410" cy="252" r="1" fill="white" opacity="0.3"/>

  <!-- Foam shavings on floor -->
  <ellipse cx="300" cy="510" rx="40" ry="8" fill="white" opacity="0.08" transform="rotate(-8,300,510)"/>
  <ellipse cx="520" cy="505" rx="35" ry="7" fill="white" opacity="0.06" transform="rotate(5,520,505)"/>
  <ellipse cx="420" cy="520" rx="55" ry="9" fill="white" opacity="0.07"/>

  <!-- Floor boards hint -->
  <line x1="0" y1="470" x2="900" y2="470" stroke="#2a1f0e" stroke-width="1" opacity="0.4"/>
  <line x1="0" y1="510" x2="900" y2="510" stroke="#1a1208" stroke-width="1" opacity="0.3"/>
  <line x1="0" y1="550" x2="900" y2="550" stroke="#2a1f0e" stroke-width="0.5" opacity="0.2"/>
  <!-- Floor planks vertical -->
  <line x1="120" y1="470" x2="100" y2="700" stroke="#1a1208" stroke-width="1" opacity="0.2"/>
  <line x1="280" y1="470" x2="260" y2="700" stroke="#1a1208" stroke-width="1" opacity="0.15"/>
  <line x1="450" y1="470" x2="430" y2="700" stroke="#1a1208" stroke-width="1" opacity="0.2"/>
  <line x1="620" y1="470" x2="600" y2="700" stroke="#1a1208" stroke-width="1" opacity="0.15"/>
  <line x1="780" y1="470" x2="760" y2="700" stroke="#1a1208" stroke-width="1" opacity="0.2"/>

  <!-- Ambient glow around work light on board -->
  <ellipse cx="420" cy="325" rx="180" ry="50" fill="#ffe8a0" opacity="0.04"/>

  <!-- Wall texture / grain overlay hint -->
  <rect width="900" height="700" fill="url(#roomGrad)" opacity="0.15"/>
</svg>
</div>
<div class="bg-overlay"></div>

<!-- PROFILE MODAL -->
<div class="modal-backdrop" id="modal">
  <div class="modal">
    <div class="modal-title">Edit Profile</div>
    <div class="modal-sub">Updates across the whole app</div>
    <div class="field"><label class="field-label">Your Name</label><input type="text" id="p-name" placeholder="e.g. Conor"/></div>
    <div class="field">
      <label class="field-label">Skill Level</label>
      <select id="p-skill">
        <option value="beginner">Beginner — still learning to stand up</option>
        <option value="intermediate">Intermediate — comfortable on green waves</option>
        <option value="advanced">Advanced — surfing most conditions</option>
        <option value="expert">Expert — I'm a hell man and will charge anything</option>
      </select>
    </div>
    <div class="field">
      <label class="field-label">Work Schedule</label>
      <select id="p-work">
        <option value="9to5">9–5 weekdays (weekends free)</option>
        <option value="flexible">Flexible / remote</option>
        <option value="shift">Shift work — varies</option>
        <option value="retired">Retired / student</option>
      </select>
    </div>
    <button class="modal-btn" onclick="saveProfile()">Save →</button>
  </div>
</div>

<header>
  <div class="logo-wrap"><div class="logo">QUIVER</div><div class="logo-tag">Surf Guide</div></div>
  <nav class="main-nav">
    <a href="index.html" class="nav-link">Forecast</a>
    <a href="workshop.html" class="nav-link active">Workshop</a>
    <a href="trip.html" class="nav-link">Trip</a>
  </nav>
  <button class="profile-btn" onclick="document.getElementById('modal').classList.add('show')">Edit Profile</button>
</header>

<div class="page" id="page">
  <!-- Onboarding or chat injected here -->
</div>

<script>
const ANTHROPIC_MODEL = 'claude-haiku-4-5-20251001';

// ── PROFILE ──
function getProfile(){try{const p=JSON.parse(localStorage.getItem('quiver_profile'));return p&&p.skill?p:null;}catch(e){return null;}}
function saveProfile(){
  try{
    const name=document.getElementById('p-name').value.trim()||'Surfer';
    const skill=document.getElementById('p-skill').value;
    const work=document.getElementById('p-work').value;
    localStorage.setItem('quiver_profile',JSON.stringify({name,skill,work}));
  }catch(e){}
  document.getElementById('modal').classList.remove('show');
}

// ── WORKSHOP STATE ──
function getWS(){try{return JSON.parse(localStorage.getItem('quiver_workshop'))||null;}catch(e){return null;}}
function saveWS(ws){try{localStorage.setItem('quiver_workshop',JSON.stringify(ws));}catch(e){}}
function clearWS(){try{localStorage.removeItem('quiver_workshop');}catch(e){}}

let messages = []; // conversation history

// ── ONBOARDING ──
function showOnboarding(){
  const profile = getProfile();
  const skillVal = profile?.skill || 'intermediate';
  document.getElementById('page').innerHTML = `
    <div class="onboard-wrap">
      <div class="onboard-card">
        <div class="onboard-title">YOUR<br>WORKSHOP</div>
        <div class="onboard-sub">Personalised surf coaching</div>

        <div class="q-field">
          <label class="q-label">What's your name?</label>
          <input class="q-input" id="q-name" placeholder="e.g. Conor" value="${profile?.name||''}" />
        </div>
        <div class="q-field">
          <label class="q-label">Skill level</label>
          <select class="q-select" id="q-skill">
            <option value="beginner" ${skillVal==='beginner'?'selected':''}>Beginner — still learning to stand up</option>
            <option value="intermediate" ${skillVal==='intermediate'?'selected':''}>Intermediate — comfortable on green waves</option>
            <option value="advanced" ${skillVal==='advanced'?'selected':''}>Advanced — surfing most conditions</option>
            <option value="expert" ${skillVal==='expert'?'selected':''}>Expert — I'm a hell man and will charge anything</option>
          </select>
        </div>
        <div class="q-field">
          <label class="q-label">What board are you riding?</label>
          <select class="q-select" id="q-board">
            <option value="foamie">Foamie / Softboard</option>
            <option value="longboard">Longboard</option>
            <option value="midlength">Mid-length</option>
            <option value="fish">Fish</option>
            <option value="shortboard" selected>Shortboard</option>
          </select>
        </div>
        <div class="q-field">
          <label class="q-label">How often do you surf?</label>
          <select class="q-select" id="q-freq">
            <option value="rarely">A few times a year</option>
            <option value="monthly">Once or twice a month</option>
            <option value="weekly" selected>Most weekends</option>
            <option value="frequent">A few times a week</option>
            <option value="daily">Nearly every day</option>
          </select>
        </div>
        <div class="q-field">
          <label class="q-label">What's the main thing you want to work on?</label>
          <textarea class="q-textarea" id="q-goal" placeholder="e.g. my backhand turns are weak, I struggle to read waves, I can't generate speed on small waves..."></textarea>
        </div>

        <button class="start-btn" onclick="startWorkshop()">Start My Workshop →</button>
      </div>
    </div>
  `;
}

// ── START WORKSHOP ──
async function startWorkshop(){
  const name = document.getElementById('q-name').value.trim() || 'Surfer';
  const skill = document.getElementById('q-skill').value;
  const board = document.getElementById('q-board').value;
  const freq  = document.getElementById('q-freq').value;
  const goal  = document.getElementById('q-goal').value.trim();

  if(!goal){ document.getElementById('q-goal').focus(); return; }

  // Save to profile too
  try{
    const existing = getProfile()||{};
    localStorage.setItem('quiver_profile', JSON.stringify({...existing, name, skill}));
  }catch(e){}

  // Save workshop state
  const ws = { name, skill, board, freq, goal, started: Date.now() };
  saveWS(ws);

  // Build system prompt
  const systemPrompt = buildSystemPrompt(ws);

  // First message from "user" to kick off the coaching plan
  const firstMsg = `Hi, I'm ${name}. I'm a ${skill} level surfer riding a ${board}, surfing ${freq}. The main thing I want to work on is: ${goal}`;

  messages = [];
  showChat(ws);
  await sendMessage(firstMsg, systemPrompt, true);
}

function buildSystemPrompt(ws){
  return `You are a knowledgeable and encouraging surf coach inside the Quiver surf app. You give personalised, practical coaching advice.

Surfer profile:
- Name: ${ws.name}
- Skill level: ${ws.skill}
- Board: ${ws.board}
- Surf frequency: ${ws.freq}
- Main goal: ${ws.goal}

Your coaching style:
- Be direct and specific — no fluff
- Give concrete drills and techniques the surfer can actually use
- Tailor advice to their board (longboard advice is very different from shortboard)
- Match the tone to their level — encouraging for beginners, technical for advanced/expert
- Keep responses focused — don't overload them with information at once
- Never tell them whether to go surfing or not — that's their call
- Use surf terminology naturally but explain it if they're a beginner
- You can ask follow-up questions to give better advice
- Format responses clearly — use short paragraphs, not walls of text
- If they ask about something outside surf coaching, gently redirect`;
}

// ── SHOW CHAT ──
function showChat(ws){
  document.getElementById('page').innerHTML = `
    <div class="chat-wrap">
      <div class="chat-header">
        <div class="chat-title">YOUR WORKSHOP</div>
        <div class="chat-sub">${ws.name} · ${ws.skill} · ${ws.board}</div>
      </div>
      <div class="chat-messages" id="chatMessages"></div>
      <div class="chat-input-wrap">
        <div class="chat-input-row">
          <input class="chat-input" id="chatInput" placeholder="Ask your coach anything..." onkeydown="if(event.key==='Enter'&&!event.shiftKey){event.preventDefault();sendUserMessage();}"/>
          <button class="send-btn" id="sendBtn" onclick="sendUserMessage()">Send →</button>
        </div>
        <button class="reset-btn" onclick="resetWorkshop()">↺ Start a new session</button>
      </div>
    </div>
  `;
}

// ── SEND MESSAGE ──
async function sendUserMessage(){
  const input = document.getElementById('chatInput');
  const text = input.value.trim();
  if(!text) return;
  input.value = '';
  const ws = getWS();
  await sendMessage(text, buildSystemPrompt(ws), false);
}

async function sendMessage(text, systemPrompt, isAuto){
  const messagesEl = document.getElementById('chatMessages');
  if(!messagesEl) return;

  // Add user message to history and UI (unless it's the auto first message)
  messages.push({ role:'user', content:text });
  if(!isAuto){
    messagesEl.innerHTML += `
      <div class="msg user">
        <div class="msg-label">You</div>
        <div class="msg-bubble">${text}</div>
      </div>`;
  }

  // Show typing indicator
  const typingId = 'typing-' + Date.now();
  messagesEl.innerHTML += `
    <div class="msg assistant" id="${typingId}">
      <div class="msg-label">Coach</div>
      <div class="typing"><span></span><span></span><span></span></div>
    </div>`;
  messagesEl.scrollTop = messagesEl.scrollHeight;

  // Disable input
  const sendBtn = document.getElementById('sendBtn');
  const chatInput = document.getElementById('chatInput');
  if(sendBtn) sendBtn.disabled = true;
  if(chatInput) chatInput.disabled = true;

  try{
    const response = await fetch('https://api.anthropic.com/v1/messages', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({
        model: ANTHROPIC_MODEL,
        max_tokens: 1000,
        system: systemPrompt,
        messages: messages
      })
    });

    const data = await response.json();
    const reply = data.content?.find(b=>b.type==='text')?.text || "Sorry, I couldn't get a response. Try again.";

    // Add to history
    messages.push({ role:'assistant', content:reply });

    // Replace typing with response
    const typingEl = document.getElementById(typingId);
    if(typingEl){
      typingEl.innerHTML = `
        <div class="msg-label">Coach</div>
        <div class="msg-bubble">${reply.replace(/\n/g,'<br>')}</div>`;
    }
  } catch(e) {
    const typingEl = document.getElementById(typingId);
    if(typingEl) typingEl.innerHTML = `<div class="msg-label">Coach</div><div class="msg-bubble" style="color:var(--poor)">Couldn't connect. Check your connection and try again.</div>`;
  }

  // Re-enable
  if(sendBtn) sendBtn.disabled = false;
  if(chatInput){ chatInput.disabled = false; chatInput.focus(); }
  if(messagesEl) messagesEl.scrollTop = messagesEl.scrollHeight;
}

function resetWorkshop(){
  clearWS();
  messages = [];
  showOnboarding();
}

// ── INIT ──
const ws = getWS();
if(ws) { showChat(ws); } else { showOnboarding(); }
</script>

<nav class="bottom-nav">
  <a href="index.html" class="bottom-nav-item" id="bn-forecast">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12h2M20 12h2M12 2v2M12 20v2"/><circle cx="12" cy="12" r="5"/><path d="M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M4.93 19.07l1.41-1.41M17.66 6.34l1.41-1.41"/></svg>
    <span>Forecast</span>
  </a>
  <a href="workshop.html" class="bottom-nav-item active" id="bn-workshop">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 013 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
    <span>Workshop</span>
  </a>
  <a href="trip.html" class="bottom-nav-item" id="bn-trip">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M2 12h20M12 2a15.3 15.3 0 010 20M12 2a15.3 15.3 0 000 20"/></svg>
    <span>Trip</span>
  </a>
</nav>
</body>
</html>
